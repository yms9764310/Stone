<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--命名空：namespace的名称必须指向刚刚接口类 -->
<mapper namespace="com.jc.mapper.AccountReceiveHandleBillMapper">
    <resultMap id="AccountReceiveHandleBill" type="com.jc.model.AccountReceiveHandleBill">
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="create_date" property="create_date" jdbcType="TIMESTAMP"/>
        <result column="creator" property="creator" jdbcType="INTEGER"/>
        <result column="modifier" property="modifier" jdbcType="INTEGER"/>
        <result column="modify_date" property="modify_date" jdbcType="TIMESTAMP"/>
        <result column="state" property="state" jdbcType="VARCHAR"/>
        <result column="commit_user_id" property="commit_user_id" jdbcType="INTEGER"/>
        <result column="effect_user_id" property="effect_user_id" jdbcType="INTEGER"/>
        <result column="sum_money" property="effect_user_id" jdbcType="VARCHAR"/>
        <result column="receive_date" property="receive_date" jdbcType="TIMESTAMP"/>
        <result column="account_no" property="account_no" jdbcType="VARCHAR"/>
        <result column="source_type" property="source_type" jdbcType="VARCHAR"/>
        <result column="source_id" property="source_id" jdbcType="INTEGER"/>

        <result column="creator_name" property="creator_name" jdbcType="VARCHAR"/>
        <result column="modify_name" property="modify_name" jdbcType="VARCHAR"/>
        <result column="effect_user_name" property="effect_user_name" jdbcType="VARCHAR"/>
        <result column="commit_user_name" property="commit_user_name" jdbcType="VARCHAR"/>
    </resultMap>
    <select id="selectListReceiveHandleBill"  resultType="AccountReceiveHandleBill">
SELECT
handle.id,
l.account_name creator_name,
l.account_name modify_name,
handle.account_no,
handle.create_date,
handle.modify_date,
r.display_name state,
handle.sum_money,
handle.pay_date,
handle.source_type,
u.name commit_user_name,
s.name effect_user_name,
handle.source_id
FROM
t_account_receive_handle_bill as handle
LEFT JOIN
t_sys_resource as r
on
handle.state=r.id
LEFT JOIN
t_sys_login_user as l
on
handle.creator=l.id
LEFT JOIN
t_sys_users as u
on
u.id=handle.commit_user_id
LEFT JOIN
t_sys_users as s
on
s.id=handle.effect_user_id

limit #{start,jdbcType=DECIMAL},#{end,jdbcType=DECIMAL}
    </select>
    <!--统计全部个数-->
    <select id="countAccountReceiveHandleBill" parameterType="map" resultType="Integer">
         select count(1) from t_account_pay_handle_bill
    </select>
<!--    创建应付单-->
    <insert id="saveAccountReceiveHandleBill" parameterType="AccountReceiveHandleBill" keyProperty="id" useGeneratedKeys="true">
        INSERT INTO t_account_pay_handle_bill(creator,create_date,modifier,modify_date,state,commit_user_id,effect_user_id,sum_money,pay_date,account_no,source_type,source_id)
        VALUES (#{creator},#{create_date},#{modifier},#{modify_date},#{state},#{commit_user_id},#{effect_user_id},#{sum_money},#{pay_date},#{account_no},#{source_type},#{source_id})
    </insert>

    <!--根据id查询-->
    <select id="loadAccountReceiveHandleBill" parameterType="java.lang.Integer" resultType="AccountReceiveHandleBill">
        SELECT * FROM  t_account_pay_handle_bill WHERE id=#{id,jdbcType=INTEGER}
    </select>

    <update id="updateAccountHandleBill" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Dec 04 11:17:05 CST 2017.
        -->
        update t_account_pay_handle_bill
        set
        state = 6
        where id = #{id}
    </update>
</mapper>
